import{s as w,x as T}from"./lit-element-10b89e96.js";function I(n,t,i,e,s){y(n,t,i||0,e||n.length-1,s||v)}function y(n,t,i,e,s){for(;e>i;){if(e-i>600){var r=e-i+1,h=t-i+1,l=Math.log(r),a=.5*Math.exp(2*l/3),o=.5*Math.sqrt(l*a*(r-a)/r)*(h-r/2<0?-1:1),c=Math.max(i,Math.floor(t-h*a/r+o)),m=Math.min(e,Math.floor(t+(r-h)*a/r+o));y(n,t,c,m,s)}var f=n[t],x=i,u=e;for(g(n,i,t),s(n[e],f)>0&&g(n,i,e);x<u;){for(g(n,x,u),x++,u--;s(n[x],f)<0;)x++;for(;s(n[u],f)>0;)u--}s(n[i],f)===0?g(n,i,u):(u++,g(n,u,e)),u<=t&&(i=u+1),t<=u&&(e=u-1)}}function g(n,t,i){var e=n[t];n[t]=n[i],n[i]=e}function v(n,t){return n<t?-1:n>t?1:0}let R=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let i=this.data;const e=[];if(!X(t,i))return e;const s=this.toBBox,r=[];for(;i;){for(let h=0;h<i.children.length;h++){const l=i.children[h],a=i.leaf?s(l):l;X(t,a)&&(i.leaf?e.push(l):E(t,a)?this._all(l,e):r.push(l))}i=r.pop()}return e}collides(t){let i=this.data;if(!X(t,i))return!1;const e=[];for(;i;){for(let s=0;s<i.children.length;s++){const r=i.children[s],h=i.leaf?this.toBBox(r):r;if(X(t,h)){if(i.leaf||E(t,h))return!0;e.push(r)}}i=e.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let i=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=i;else if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){const e=this.data;this.data=i,i=e}this._insert(i,this.data.height-i.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=p([]),this}remove(t,i){if(!t)return this;let e=this.data;const s=this.toBBox(t),r=[],h=[];let l,a,o;for(;e||r.length;){if(e||(e=r.pop(),a=r[r.length-1],l=h.pop(),o=!0),e.leaf){const c=A(t,e.children,i);if(c!==-1)return e.children.splice(c,1),r.push(e),this._condense(r),this}!o&&!e.leaf&&E(e,s)?(r.push(e),h.push(l),l=0,a=e,e=e.children[0]):a?(l++,e=a.children[l],o=!1):e=null}return this}toBBox(t){return t}compareMinX(t,i){return t.minX-i.minX}compareMinY(t,i){return t.minY-i.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,i){const e=[];for(;t;)t.leaf?i.push(...t.children):e.push(...t.children),t=e.pop();return i}_build(t,i,e,s){const r=e-i+1;let h=this._maxEntries,l;if(r<=h)return l=p(t.slice(i,e+1)),d(l,this.toBBox),l;s||(s=Math.ceil(Math.log(r)/Math.log(h)),h=Math.ceil(r/Math.pow(h,s-1))),l=p([]),l.leaf=!1,l.height=s;const a=Math.ceil(r/h),o=a*Math.ceil(Math.sqrt(h));S(t,i,e,o,this.compareMinX);for(let c=i;c<=e;c+=o){const m=Math.min(c+o-1,e);S(t,c,m,a,this.compareMinY);for(let f=c;f<=m;f+=a){const x=Math.min(f+a-1,m);l.children.push(this._build(t,f,x,s-1))}}return d(l,this.toBBox),l}_chooseSubtree(t,i,e,s){for(;s.push(i),!(i.leaf||s.length-1===e);){let r=1/0,h=1/0,l;for(let a=0;a<i.children.length;a++){const o=i.children[a],c=Y(o),m=O(t,o)-c;m<h?(h=m,r=c<r?c:r,l=o):m===h&&c<r&&(r=c,l=o)}i=l||i.children[0]}return i}_insert(t,i,e){const s=e?t:this.toBBox(t),r=[],h=this._chooseSubtree(s,this.data,i,r);for(h.children.push(t),B(h,s);i>=0&&r[i].children.length>this._maxEntries;)this._split(r,i),i--;this._adjustParentBBoxes(s,r,i)}_split(t,i){const e=t[i],s=e.children.length,r=this._minEntries;this._chooseSplitAxis(e,r,s);const h=this._chooseSplitIndex(e,r,s),l=p(e.children.splice(h,e.children.length-h));l.height=e.height,l.leaf=e.leaf,d(e,this.toBBox),d(l,this.toBBox),i?t[i-1].children.push(l):this._splitRoot(e,l)}_splitRoot(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,d(this.data,this.toBBox)}_chooseSplitIndex(t,i,e){let s,r=1/0,h=1/0;for(let l=i;l<=e-i;l++){const a=_(t,0,l,this.toBBox),o=_(t,l,e,this.toBBox),c=$(a,o),m=Y(a)+Y(o);c<r?(r=c,s=l,h=m<h?m:h):c===r&&m<h&&(h=m,s=l)}return s||e-i}_chooseSplitAxis(t,i,e){const s=t.leaf?this.compareMinX:C,r=t.leaf?this.compareMinY:N,h=this._allDistMargin(t,i,e,s),l=this._allDistMargin(t,i,e,r);h<l&&t.children.sort(s)}_allDistMargin(t,i,e,s){t.children.sort(s);const r=this.toBBox,h=_(t,0,i,r),l=_(t,e-i,e,r);let a=M(h)+M(l);for(let o=i;o<e-i;o++){const c=t.children[o];B(h,t.leaf?r(c):c),a+=M(h)}for(let o=e-i-1;o>=i;o--){const c=t.children[o];B(l,t.leaf?r(c):c),a+=M(l)}return a}_adjustParentBBoxes(t,i,e){for(let s=e;s>=0;s--)B(i[s],t)}_condense(t){for(let i=t.length-1,e;i>=0;i--)t[i].children.length===0?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():d(t[i],this.toBBox)}};function A(n,t,i){if(!i)return t.indexOf(n);for(let e=0;e<t.length;e++)if(i(n,t[e]))return e;return-1}function d(n,t){_(n,0,n.children.length,t,n)}function _(n,t,i,e,s){s||(s=p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r=t;r<i;r++){const h=n.children[r];B(s,n.leaf?e(h):h)}return s}function B(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function C(n,t){return n.minX-t.minX}function N(n,t){return n.minY-t.minY}function Y(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function M(n){return n.maxX-n.minX+(n.maxY-n.minY)}function O(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function $(n,t){const i=Math.max(n.minX,t.minX),e=Math.max(n.minY,t.minY),s=Math.min(n.maxX,t.maxX),r=Math.min(n.maxY,t.maxY);return Math.max(0,s-i)*Math.max(0,r-e)}function E(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function X(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function p(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(n,t,i,e,s){const r=[t,i];for(;r.length;){if(i=r.pop(),t=r.pop(),i-t<=e)continue;const h=t+Math.ceil((i-t)/e/2)*e;I(n,h,t,i,s),r.push(t,h,h,i)}}const q=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));class J extends w{constructor(){super(...arguments),this.templates={},this._renderedTemplates={}}setBindingSyntax(t,i){this._startExpression=t,this._endExpression=i;const e=this.escapeRegex(this._startExpression),s=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${e}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${s}`,"g")}hasTemplate(t){return this.templates&&!!this.templates[t]}renderTemplate(t,i,e){if(!this.hasTemplate(t))return null;e=e||t;const s=T` <slot name=${e}></slot> `,r={[t]:{...i}};if(this._renderedTemplates.hasOwnProperty(e)){const{slot:l}=this._renderedTemplates[e];this.contains(l)&&this.removeChild(l)}const h=document.createElement("div");return h.slot=e,h.dataset.generated="template",this._renderTemplate(h,this.templates[t],r),this.appendChild(h),this._renderedTemplates[e]={context:r,slot:h},s}getTemplates(){const t={};for(let i=0;i<this.children.length;i++){const e=this.children[i];if(e.nodeName==="RENDER-TEMPLATE"){const s=e;s.dataset.type?t[s.dataset.type]=s:t.default=s,s.templateOrder=i}}return t}_renderTemplate(t,i,e){let s;if(i&&i.childNodes.length){const r=i.cloneNode(!0);s=this.renderNode(r,t,e)}s&&t.appendChild(s)}expandExpressionsAsString(t,i){return t.replace(this.expression,(e,s)=>{const r=this.evalInContext(s||this.trimExpression(e),i);return r?typeof r=="object"?JSON.stringify(r):r.toString():""})}get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}escapeRegex(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}evalInContext(t,i){i={...i};const e=new Function("with(this) { return "+t+";}");let s;try{s=e.call(i)}catch{}return s}trimExpression(t){return t=t.trim(),t.startsWith(this._startExpression)&&t.endsWith(this._endExpression)&&(t=t.substr(this._startExpression.length,t.length-this._startExpression.length-this._endExpression.length),t=t.trim()),t}renderNode(t,i,e){if(t.nodeName==="#text")return t.textContent=this.expandExpressionsAsString(t.textContent,e),t;if(t.nodeName==="TEMPLATE")return t.$parentTemplateContext=e,t;for(let s=0;s<t.childNodes.length;s++){const r=t.childNodes[s];this.renderNode(r,i,e)}return t}firstUpdated(){this.templates=this.getTemplates()}}export{R,J as T,q as r};
//# sourceMappingURL=templateElement-172ca5d9.js.map
